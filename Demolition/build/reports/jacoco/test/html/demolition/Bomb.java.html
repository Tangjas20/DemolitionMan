<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Bomb.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Demolition</a> &gt; <a href="index.source.html" class="el_package">demolition</a> &gt; <span class="el_source">Bomb.java</span></div><h1>Bomb.java</h1><pre class="source lang-java linenums">package demolition;

import processing.core.PImage;
import processing.core.PApplet;
import java.util.Arrays;

/**
*Extends from GameObject class to create a bomb which will tick for 2 seconds before exploding. This class will implement the core logic as well as loading the sprites and creating a path for explosions to occur
 */

public class Bomb extends GameObject {
    private String[][] currentBoard;
<span class="fc" id="L13">    private PImage[] bombSprite = new PImage[8];</span>
<span class="fc" id="L14">    private PImage[] explosionSprite = new PImage[7];</span>
<span class="fc" id="L15">    private int[] explodablePath = {0, 0, 0, 0};</span>
    boolean explosionFinished;
    int timerSprite;
    private int currentSprite;
    private boolean isAlive;
<span class="fc" id="L20">    boolean killedPlayer = false;</span>
<span class="fc" id="L21">    boolean killedYellowEnemy = false;</span>
<span class="fc" id="L22">    boolean killedRedEnemy = false;</span>
<span class="fc" id="L23">    boolean brokenWallTF = false;</span>

    /**
    * Takes in the x and y coordinates of the player and currentBoard as well as PApplet app which will be used to find the positioning of the bomb on the map and determine its explosion.
    */
    public Bomb(int x, int y, PApplet app, String[][] currentBoard){
<span class="fc" id="L29">        super(x, y, app);</span>
<span class="fc" id="L30">        this.currentBoard = currentBoard;</span>

<span class="fc" id="L32">        this.bombSprite[0] = app.loadImage(&quot;src/main/resources/bomb/bomb1.png&quot;);</span>
<span class="fc" id="L33">        this.bombSprite[1] = app.loadImage(&quot;src/main/resources/bomb/bomb2.png&quot;);</span>
<span class="fc" id="L34">        this.bombSprite[2] = app.loadImage(&quot;src/main/resources/bomb/bomb3.png&quot;);</span>
<span class="fc" id="L35">        this.bombSprite[3] = app.loadImage(&quot;src/main/resources/bomb/bomb4.png&quot;);</span>
<span class="fc" id="L36">        this.bombSprite[4] = app.loadImage(&quot;src/main/resources/bomb/bomb5.png&quot;);</span>
<span class="fc" id="L37">        this.bombSprite[5] = app.loadImage(&quot;src/main/resources/bomb/bomb6.png&quot;);</span>
<span class="fc" id="L38">        this.bombSprite[6] = app.loadImage(&quot;src/main/resources/bomb/bomb7.png&quot;);</span>
<span class="fc" id="L39">        this.bombSprite[7] = app.loadImage(&quot;src/main/resources/bomb/bomb8.png&quot;);</span>

        
<span class="fc" id="L42">        this.explosionSprite[0] = app.loadImage(&quot;src/main/resources/explosion/centre.png&quot;);</span>
<span class="fc" id="L43">        this.explosionSprite[1] = app.loadImage(&quot;src/main/resources/explosion/horizontal.png&quot;);</span>
<span class="fc" id="L44">        this.explosionSprite[2] = app.loadImage(&quot;src/main/resources/explosion/vertical.png&quot;);</span>
<span class="fc" id="L45">        this.explosionSprite[3] = app.loadImage(&quot;src/main/resources/explosion/end_top.png&quot;);</span>
<span class="fc" id="L46">        this.explosionSprite[4] = app.loadImage(&quot;src/main/resources/explosion/end_right.png&quot;);</span>
<span class="fc" id="L47">        this.explosionSprite[5] = app.loadImage(&quot;src/main/resources/explosion/end_bottom.png&quot;);</span>
<span class="fc" id="L48">        this.explosionSprite[6] = app.loadImage(&quot;src/main/resources/explosion/end_left.png&quot;);</span>

<span class="fc" id="L50">        this.currentSprite = 0;</span>
<span class="fc" id="L51">        this.timerSprite = 0;</span>
<span class="fc" id="L52">        this.isAlive = true;</span>
<span class="fc" id="L53">        this.explosionFinished = false;</span>
<span class="fc" id="L54">        setCanExplodePath();</span>
<span class="fc" id="L55">    }</span>

    /**
    * Checks 2 blocks in each direction N, E, S, W and determines how far the explosion should occur in. Changes the explodablePath attribute to an int array which stores values to be used in the explosion
    */
    public void setCanExplodePath(){//Creates an int array to be used to record how far explosion goes
<span class="fc bfc" id="L61" title="All 2 branches covered.">        if(this.currentBoard[y][x+1].equals(&quot;W&quot;)){</span>
            ;
        }//Right
<span class="fc bfc" id="L64" title="All 2 branches covered.">        else if(this.currentBoard[y][x+1].matches(&quot; |R|Y|P&quot;)){</span>
<span class="fc" id="L65">            explodablePath[3] ++;</span>
<span class="fc bfc" id="L66" title="All 2 branches covered.">            if(this.currentBoard[y][x+2].matches(&quot; |R|Y|P|B&quot;)){</span>
<span class="fc" id="L67">                explodablePath[3] ++;</span>
            }
        }
<span class="pc bpc" id="L70" title="1 of 2 branches missed.">        else if(this.currentBoard[y][x+1].equals(&quot;B&quot;)){</span>
<span class="fc" id="L71">                explodablePath[3] += 3;</span>
            }
        //Left
<span class="fc bfc" id="L74" title="All 2 branches covered.">        if(this.currentBoard[y][x-1].equals(&quot;W&quot;)){</span>
            ;
        }
<span class="fc bfc" id="L77" title="All 2 branches covered.">        else if(this.currentBoard[y][x-1].matches(&quot; |R|Y|P&quot;)){</span>
<span class="fc" id="L78">            explodablePath[0] ++;</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">            if(this.currentBoard[y][x-2].matches(&quot; |R|Y|P|B&quot;)){</span>
<span class="fc" id="L80">                explodablePath[0] ++;</span>
            }
        }
<span class="fc bfc" id="L83" title="All 2 branches covered.">        else if(this.currentBoard[y][x-1].equals(&quot;B&quot;)){</span>
<span class="fc" id="L84">                explodablePath[0] += 3;</span>
            }
        //DOWN
<span class="fc bfc" id="L87" title="All 2 branches covered.">        if(this.currentBoard[y+1][x].equals(&quot;W&quot;)){</span>
            ;
        }
<span class="fc bfc" id="L90" title="All 2 branches covered.">        else if(this.currentBoard[y+1][x].matches(&quot; |R|Y|P&quot;)){</span>
<span class="fc" id="L91">            explodablePath[2] ++;</span>
<span class="fc bfc" id="L92" title="All 2 branches covered.">            if(this.currentBoard[y+2][x].matches(&quot; |R|Y|P|B&quot;)){</span>
<span class="fc" id="L93">                explodablePath[2] ++;</span>
            }
        }
<span class="pc bpc" id="L96" title="1 of 2 branches missed.">        else if(this.currentBoard[y+1][x].equals(&quot;B&quot;)){</span>
<span class="fc" id="L97">                explodablePath[2] += 3;</span>
            }
        //UP
<span class="fc bfc" id="L100" title="All 2 branches covered.">        if(this.currentBoard[y-1][x].equals(&quot;W&quot;)){</span>
            ;
        }
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">        else if(this.currentBoard[y-1][x].matches(&quot; |R|Y|P&quot;)){</span>
<span class="fc" id="L104">            explodablePath[1] ++;</span>
<span class="fc bfc" id="L105" title="All 2 branches covered.">            if(this.currentBoard[y-2][x].matches(&quot; |R|Y|P|B&quot;)){</span>
<span class="fc" id="L106">                explodablePath[1] ++;</span>
            }
        }
<span class="nc bnc" id="L109" title="All 2 branches missed.">        else if(this.currentBoard[y-1][x].equals(&quot;B&quot;)){</span>
<span class="nc" id="L110">                explodablePath[1] += 3;</span>
            }
        
<span class="fc" id="L113">        this.explodablePath = explodablePath;</span>
<span class="fc" id="L114">    }</span>
    
    /**
    * Draws the explosion sprites depending on the value in the int array from the setCanExplodePath method. This ensures that the correct animations are delivered when the explosion occurs. I.e If there is a broken wall closest to the bomb, that direction will only show explosion for one block.
    */
    public void drawExplosion(PApplet app) {//Left
<span class="fc" id="L120">        app.image(explosionSprite[0], this.x*32, this.y*32+64);</span>
<span class="pc bpc" id="L121" title="1 of 4 branches missed.">        if (explodablePath[0] == 1 || explodablePath[0] == 3) app.image(explosionSprite[6], this.x*32-32, this.y*32+64); //Left Close</span>
<span class="fc bfc" id="L122" title="All 2 branches covered.">        else if (explodablePath[0] == 2) {//Left Far</span>
<span class="fc" id="L123">            app.image(explosionSprite[1], this.x*32-32, this.y*32+64);</span>
<span class="fc" id="L124">            app.image(explosionSprite[6], this.x*32-64, this.y*32+64);</span>
        }
        //UP
<span class="pc bpc" id="L127" title="2 of 4 branches missed.">        if (explodablePath[1] == 1 || explodablePath[1] == 3) app.image(explosionSprite[3], this.x*32, this.y*32+64-32);</span>
<span class="fc bfc" id="L128" title="All 2 branches covered.">        else if (explodablePath[1] == 2) {</span>
<span class="fc" id="L129">            app.image(explosionSprite[2], this.x*32, this.y*32+64-32);</span>
<span class="fc" id="L130">            app.image(explosionSprite[3], this.x*32, this.y*32+64-64);</span>
        }//DOWN
<span class="pc bpc" id="L132" title="2 of 4 branches missed.">        if (explodablePath[2] == 1 || explodablePath[2] == 3) app.image(explosionSprite[5], this.x*32, this.y*32+64+32);</span>
<span class="fc bfc" id="L133" title="All 2 branches covered.">        else if (explodablePath[2] == 2) {</span>
<span class="fc" id="L134">            app.image(explosionSprite[2], this.x*32, this.y*32+32+64);</span>
<span class="fc" id="L135">            app.image(explosionSprite[5], this.x*32, this.y*32+64+64);</span>
        }//RIGHT
<span class="pc bpc" id="L137" title="1 of 4 branches missed.">        if (explodablePath[3] == 1 || explodablePath[3] == 3) app.image(explosionSprite[4], this.x*32+32, this.y*32+64);</span>
<span class="fc bfc" id="L138" title="All 2 branches covered.">        else if (explodablePath[3] == 2) {</span>
<span class="fc" id="L139">            app.image(explosionSprite[1], this.x*32+32, this.y*32+64);</span>
<span class="fc" id="L140">            app.image(explosionSprite[4], this.x*32+64, this.y*32+64);</span>
        }
<span class="fc" id="L142">        timerSprite += 1;</span>
<span class="fc bfc" id="L143" title="All 2 branches covered.">        if (timerSprite == 30) {</span>
<span class="fc" id="L144">            this.explosionFinished = true;</span>
        }
<span class="fc" id="L146">    }</span>

    /**
    *Draws the bomb sprite and changes the sprite based on the time elapsed. Will change the boolean isAlive 
    */
    public void draw(PApplet app) {//draws bomb sprite
<span class="fc" id="L152">        app.image(bombSprite[currentSprite], this.x*32, this.y*32+64);</span>
<span class="fc" id="L153">        timerSprite += 1;</span>

<span class="fc bfc" id="L155" title="All 2 branches covered.">        if(timerSprite == 15) {</span>
<span class="fc" id="L156">            timerSprite = 0;</span>
<span class="fc" id="L157">            currentSprite += 1;</span>
<span class="fc bfc" id="L158" title="All 2 branches covered.">            if (currentSprite &gt; 7) {</span>
<span class="fc" id="L159">                currentSprite = 0;</span>
<span class="fc" id="L160">                this.isAlive = false;</span>
<span class="fc" id="L161">                timerSprite = 0;</span>
            }
        }

<span class="fc" id="L165">    }</span>
    
    /**
    *
    */
    public void explosion(App app) {//Calls upon explode method to change the currentBoard terrain and enemies
        //Left
<span class="fc bfc" id="L172" title="All 2 branches covered.">      if (explode(this.x-1, this.y, app)) </span>
<span class="fc" id="L173">            explode(this.x-2, this.y, app);</span>
      //Down
<span class="fc bfc" id="L175" title="All 2 branches covered.">      if (explode(this.x, this.y+1, app))</span>
<span class="fc" id="L176">            explode(this.x, this.y+2, app);</span>
      //Right
<span class="fc bfc" id="L178" title="All 2 branches covered.">      if (explode(this.x+1, this.y, app)) </span>
<span class="fc" id="L179">            explode(this.x+2, this.y, app);</span>
      //Up
<span class="fc bfc" id="L181" title="All 2 branches covered.">      if (explode(this.x, this.y-1, app)) </span>
<span class="fc" id="L182">            explode(this.x, this.y-2, app);</span>
            
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">      if (explode(this.x, this.y, app));</span>
<span class="fc" id="L185">    }</span>

    public boolean explode(int row, int column, App app) {
<span class="fc" id="L188">        String tile = app.currentBoard[column][row];</span>

<span class="fc bfc" id="L190" title="All 2 branches covered.">        if (tile.equals(&quot; &quot;)) {</span>
<span class="fc" id="L191">          return true;</span>
<span class="fc bfc" id="L192" title="All 2 branches covered.">        } else if (tile.equals(&quot;B&quot;)) {</span>
<span class="fc" id="L193">            this.currentBoard[column][row] = &quot; &quot;;</span>
<span class="fc" id="L194">            return false;</span>

<span class="fc bfc" id="L196" title="All 2 branches covered.">        } else if (tile.equals(&quot;P&quot;)) {</span>
<span class="fc" id="L197">            killedPlayer = true;</span>
<span class="fc" id="L198">            return true;</span>

<span class="fc bfc" id="L200" title="All 2 branches covered.">        } else if (tile.equals(&quot;Y&quot;)) {</span>
<span class="fc" id="L201">            this.currentBoard[column][row] = &quot; &quot;;</span>
<span class="fc bfc" id="L202" title="All 2 branches covered.">            for(yellowEnemy i: app.board.yellowEnemyList){</span>
<span class="pc bpc" id="L203" title="3 of 4 branches missed.">                if(i.getX() == row &amp;&amp; i.getY() == column){</span>
<span class="nc" id="L204">                    i.isEnemyDead = true;</span>
                }
<span class="fc" id="L206">            }</span>
<span class="pc bpc" id="L207" title="1 of 2 branches missed.">            app.board.yellowEnemyList.removeIf(b -&gt; b.isEnemyDead == true);</span>
<span class="fc" id="L208">            killedYellowEnemy = true;</span>
<span class="fc" id="L209">            return true;</span>

<span class="fc bfc" id="L211" title="All 2 branches covered.">        } else if (tile.equals(&quot;R&quot;)) {</span>
<span class="fc" id="L212">            this.currentBoard[column][row] = &quot; &quot;;</span>
<span class="fc bfc" id="L213" title="All 2 branches covered.">            for(redEnemy i: app.board.redEnemyList){</span>
<span class="pc bpc" id="L214" title="1 of 4 branches missed.">                if(i.getX() == row &amp;&amp; i.getY() == column){</span>
<span class="fc" id="L215">                    i.isEnemyDead = true;</span>
                }
<span class="fc" id="L217">            }</span>
<span class="fc bfc" id="L218" title="All 2 branches covered.">            app.board.redEnemyList.removeIf(b -&gt; b.isEnemyDead == true);</span>
<span class="fc" id="L219">            killedRedEnemy = true;</span>
<span class="fc" id="L220">            return true;</span>
        }
<span class="fc" id="L222">        return false;</span>

    }

    public boolean getIsAlive(){
<span class="fc" id="L227">        return this.isAlive;</span>
    }
    
    public void notAlive(){
<span class="fc" id="L231">        this.isAlive = false;</span>
<span class="fc" id="L232">    }</span>

    public boolean getExplosionFinished(){
<span class="fc" id="L235">        return this.explosionFinished;</span>
    }

    public String[][] getBoard(){
<span class="fc" id="L239">        return this.currentBoard;</span>
    }

    public int getCurrentSprite(){
<span class="fc" id="L243">        return this.currentSprite;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>